<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />




<title>figures.utf8.md</title>

<script src="figures_files/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="figures_files/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="figures_files/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="figures_files/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="figures_files/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="figures_files/navigation-1.1/tabsets.js"></script>
<script src="figures_files/navigation-1.1/codefolding.js"></script>
<link href="figures_files/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="figures_files/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>



<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>






<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>




</div>


<a href="https://github.com/fawda123/Pteropod_biomarker/" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#FD6C6C; color:#fff; position: absolute; top: 0; border: 0; left: 0; transform: scale(-1, 1);" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>
<style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
<div id="pteropod-stressor-interaction-figures" class="section level1">
<h1>Pteropod stressor interaction: figures</h1>
<pre class="r"><code>library(tidyverse)
library(vegan)
library(ggord)
library(scales)
library(effects)
library(knitr)
library(gridExtra)
library(grid)
library(stargazer)

source(&quot;R/funcs.R&quot;)

opts_chunk$set(fig.align = &#39;center&#39;, message = F, echo = T, cache = F, dev = &#39;png&#39;, dev.args = list(family = &#39;serif&#39;), dpi = 400, fig.pos = &#39;!h&#39;, warning = F, background = &#39;white&#39;, out.width = &#39;100%&#39;,
               fig.process = function(x) {
                 x2 = sub(&#39;-\\d+([.][a-z]+)$&#39;, &#39;\\1&#39;, x)
                 if (file.rename(x, x2)) x2 else x
               })

data(envdat)
data(ptedat)
data(phymod)
data(biomod)

envchr &lt;- c(&#39;Lat&#39;, &#39;pCO2&#39;, &#39;pH&#39;, &#39;Ara&#39;, &#39;O2&#39;, &#39;Temp&#39;, &#39;Fluor&#39;)
biochr &lt;- c(&#39;CAT&#39;, &#39;GR&#39;, &#39;GSHonGSSG&#39;, &#39;GST&#39;, &#39;LPX&#39;, &#39;ORAC&#39;, &#39;SOD&#39;, &#39;ORACvLPX&#39;)
phychr &lt;- c(&#39;abu&#39;, &#39;dis&#39;, &#39;len&#39;, &#39;ty2&#39;, &#39;ty3&#39;, &#39;scr&#39;)</code></pre>
<pre class="r"><code># biomarker rda model
dat_bio &lt;- ptedat %&gt;% 
  select(one_of(&#39;CTD&#39;, biochr)) %&gt;% 
  na.omit %&gt;% 
  inner_join(envdat, by = &#39;CTD&#39;) %&gt;% 
  select(one_of(c(&#39;CTD&#39;, envchr, biochr))) %&gt;% 
  data.frame %&gt;% 
  remove_rownames %&gt;% 
  column_to_rownames(&#39;CTD&#39;)

envphy &lt;- select(dat_bio, one_of(envchr)) %&gt;% 
  select(-Lat) %&gt;% 
  rename(Chla = Fluor) %&gt;% 
  decostand(method = &#39;range&#39;)
ptephy &lt;- select(dat_bio, one_of(biochr)) %&gt;% 
  decostand(method = &#39;range&#39;)

biorda&lt;- rda(ptephy, envphy)

# physiology rda model
dat_phy &lt;- ptedat %&gt;% 
  select(one_of(&#39;CTD&#39;, phychr)) %&gt;% 
  na.omit %&gt;% 
  inner_join(envdat, by = &#39;CTD&#39;) %&gt;% 
  select(one_of(c(&#39;CTD&#39;, envchr, phychr))) %&gt;% 
  data.frame %&gt;% 
  remove_rownames %&gt;% 
  column_to_rownames(&#39;CTD&#39;) %&gt;% 
  rename(
    abundance = abu, 
    dissolution = dis, 
    length = len, 
    scarring = scr, 
    typeII = ty2, 
    typeIII = ty3
  )

envphy &lt;- select(dat_phy, one_of(envchr)) %&gt;% 
  select(-Lat) %&gt;%
  rename(Chla = Fluor) %&gt;% 
  decostand(method = &#39;range&#39;)
ptephy &lt;- select(dat_phy, -one_of(envchr)) %&gt;% 
  decostand(method = &#39;range&#39;)

phyrda &lt;- rda(ptephy, envphy)</code></pre>
<pre class="r"><code># globals
coord_fix &lt;- F
repel &lt;- F
addsize &lt;- 3
alpha &lt;- 0.8
arrow &lt;- 0.3
cols &lt;- &#39;lightblue&#39;

scalbio &lt;- range(dat_bio$Lat)
scalbio &lt;- seq(scalbio[1], scalbio[2], length  = 5)
scalphy &lt;- range(dat_phy$Lat)
scalphy &lt;- seq(scalphy[1], scalphy[2], length  = 5)

p1a &lt;- ggord(biorda, ptslab = T, parse = T, repel = repel, coord_fix = coord_fix, addsize = addsize, size = dat_bio$Lat, sizelab = &#39;Latitude&#39;, alpha = alpha, arrow = arrow, ellipse = F) + 
  ggtitle(&#39;(a) Cellular endpoints&#39;) + 
  scale_size(breaks = scalbio, labels = round(scalbio, 1), range = c(1, 8))
p2a &lt;- ggord(phyrda, ptslab = T, parse = T, repel = repel, coord_fix = coord_fix, addsize = addsize, size = dat_phy$Lat, sizelab = &#39;Latitude&#39;, alpha = alpha, arrow = arrow, ellipse = F) + 
  ggtitle(&#39;(b) Physiological endpoints&#39;) + 
  scale_size(breaks = scalphy, labels = round(scalphy, 1), range = c(1, 8))

grid.arrange(p1a, p2a, ncol = 2)</code></pre>
<p><img src="figures_files/figure-html/rdaplo.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Fig. 4 Results of redundancy analyses for environmental variables with (a) cellular and (b) physiological endpoints of pteropod response to OA stressors. Points are site locations in multivariate space with the size proportional to latitude. Separate RDAs were created for cellular and physiological endpoints because not all data were available across all stations.</p>
<pre class="r"><code># physiology rda model
dat_cor &lt;- ptedat %&gt;% 
  select(one_of(&#39;CTD&#39;, phychr, biochr)) %&gt;% 
  # na.omit %&gt;% 
  left_join(envdat, by = &#39;CTD&#39;) %&gt;% 
  data.frame %&gt;% 
  remove_rownames %&gt;% 
  column_to_rownames(&#39;CTD&#39;)

# all correlations
crs &lt;- crossing(var1 = names(dat_cor), var2 = names(dat_cor)) %&gt;% 
  filter(var1 != var2) %&gt;% 
  rownames_to_column() %&gt;% 
  group_by(rowname) %&gt;% 
  nest %&gt;% 
  mutate(
    crs = map(data, function(x){
      
      # variables
      vr1 &lt;- dat_cor[[x$var1]]
      vr2 &lt;- dat_cor[[x$var2]]
      
      # pearson
      pr_ts &lt;- cor.test(vr1, vr2, method = &#39;pearson&#39;)
      pr_cr &lt;- round(pr_ts$estimate, 2)
      pr_pv &lt;- p_ast(pr_ts$p.value)
      pr &lt;- paste(pr_cr, pr_pv)
    
      out &lt;- data.frame(pr = pr, stringsAsFactors = F)
      return(out)
      
    })
  ) %&gt;% 
  unnest %&gt;% 
  select(-rowname)</code></pre>
<pre class="r"><code>levs &lt;- c(sort(envchr), sort(biochr), sort(phychr))
labs &lt;- c(&#39;Omega[ar]&#39;, &#39;Chla&#39;, &#39;Lat&#39;, &#39;O[2]&#39;, &#39;pCO[2]&#39;, &#39;pH&#39;, &#39;Temp&#39;, &#39;CAT&#39;, &#39;GR&#39;, &#39;GSHonGSSG&#39;, &#39;GST&#39;, &#39; LPX&#39;, &#39;ORAC&#39;, &#39;ORACvLPX&#39;, &#39;SOD&#39;, &#39;abundance&#39;, &#39;dissolution&#39;, &#39;length&#39;, &#39;scarring&#39;, &#39;typeII&#39;, &#39;typeIII&#39;)
prplo &lt;- crs %&gt;% 
  separate(pr, c(&#39;cor&#39;, &#39;sig&#39;), sep = &#39; &#39;) %&gt;% 
  filter(var1 %in% levs &amp; var2 %in% levs) %&gt;%  
  mutate(
    cor = as.numeric(cor), 
    var1 = factor(var1, levels = rev(levs), labels = rev(labs)), 
    var2 = factor(var2, levels = rev(levs), labels = rev(labs)), 
    sig = gsub(&#39;ns&#39;, &#39;&#39;, sig)
  )

pbase &lt;- theme(
  panel.grid.major = element_blank(), 
  panel.grid.minor = element_blank(), 
  axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, size = 8), 
  axis.text.y = element_text(size = 8),
  legend.position = c(0.5, 1.12),
  legend.direction = &#39;horizontal&#39;,
  plot.margin = unit(c(4,4,0,0), &quot;lines&quot;),
  strip.background = element_blank(), 
  strip.text.y = element_text(angle = 0, hjust = 0, vjust = 0.5), 
  panel.background = element_rect(fill = &#39;black&#39;)
  ) 

outlab &lt;- data.frame(
  y = c(3.5, 10.5, 18.5), 
  lab = c(&#39;Population/\nPhysiology&#39;, &#39;Cellular&#39;, &#39;Environment&#39;)
)

p &lt;- ggplot(prplo) + 
  geom_tile(aes(y = var1, x = var2, fill = cor), colour = &#39;black&#39;) + 
  geom_text(aes(y = var1, x = var2, label = sig)) +
  annotation_custom(grob = textGrob(label = outlab$lab[1], hjust = 0, gp = gpar(cex = 0.7)),
                    ymin = outlab$y[1], ymax = outlab$y[1], xmin = 22, xmax = 22) +
  annotation_custom(grob = textGrob(label = outlab$lab[2], hjust = 0, gp = gpar(cex = 0.7)),
                    ymin = outlab$y[2], ymax = outlab$y[2], xmin = 22, xmax = 22) +  
  annotation_custom(grob = textGrob(label = outlab$lab[3], hjust = 0, gp = gpar(cex = 0.7)),
                    ymin = outlab$y[3], ymax = outlab$y[3], xmin = 22, xmax = 22) +
  annotation_custom(grob = textGrob(label = outlab$lab[1], hjust = 0.5, gp = gpar(cex = 0.7)),
                    xmin = outlab$y[1], xmax = outlab$y[1], ymin = 22.5, ymax = 22.5) +
  annotation_custom(grob = textGrob(label = outlab$lab[2], hjust = 0.5, gp = gpar(cex = 0.7)),
                    xmin = outlab$y[2], xmax = outlab$y[2], ymin = 22.5, ymax = 22.5) +  
  annotation_custom(grob = textGrob(label = outlab$lab[3], hjust = 0.5, gp = gpar(cex = 0.7)),
                    xmin = outlab$y[3], xmax = outlab$y[3], ymin = 22.5, ymax = 22.5) +
  pbase +
  scale_y_discrete(&#39;&#39;, expand = c(0, 0), labels = parse(text = rev(labs))) + 
  scale_x_discrete(&#39;&#39;, expand = c(0, 0), labels = parse(text = rev(labs))) +
  scale_fill_gradient2(&#39;Correlation&#39;, low = muted(&quot;blue&quot;), mid = &quot;white&quot;, high = muted(&quot;red&quot;), midpoint = 0) +
  guides(fill = guide_colourbar(barheight = 0.5, barwidth = 5, label.theme = element_text(size = 6, angle = 0))) +
  geom_hline(yintercept = 6.5, size = 1.5) +
  geom_hline(yintercept = 14.5, size = 1.5) +
  geom_vline(xintercept = 6.5, size = 1.5) +
  geom_vline(xintercept = 14.5, size = 1.5) 

# Code to override clipping
gt &lt;- ggplot_gtable(ggplot_build(p))
gt$layout$clip[gt$layout$name == &quot;panel&quot;] &lt;- &quot;off&quot;
grid.draw(gt)</code></pre>
<p><img src="figures_files/figure-html/corplo.png" width="100%" style="display: block; margin: auto;" /> Fig. 5 Correlation matrix of environmental variables, cellular response endpoints, and population (abundance) and physiological response endpoints for pteropods. Darker red values are strong positive correlations and darker purple values are strong negative correlations. Significance values at alpha = 0.05 are shown by stars (p &lt; 0.05 *, p &lt; 0.005 **).</p>
<pre class="r"><code>toplo &lt;- biomod %&gt;% 
  filter(Model %in% c(&#39;mod2&#39;, &#39;mod3&#39;, &#39;mod23&#39;)) %&gt;% 
  mutate(
    cvar = c(&#39;pCO2&#39;, &#39;Temp&#39;, &#39;Temp&#39;),
    xvar = c(&#39;Fluorescence&#39;, &#39;Omega[ar]&#39;, &#39;Omega[ar]&#39;), 
    yvar = c(&#39;LPX&#39;, &#39;LPX&#39;, &#39;SOD&#39;), 
    legr = c(&#39;pCO[2]&#39;, &#39;Temp&#39;, &#39;Temp&#39;),
    fct = c(0.5, 0.95, 0.95)
    ) %&gt;% 
  mutate(
    pldat = pmap(list(Modobj, cvar, fct), function(Modobj, cvar, fct){

      get_pldat(Modobj, cvar, fct = fct)
    
    }),
    plos = pmap(list(pldat, xvar, cvar, legr), function(pldat, xvar, cvar, legr){
      
      pl1 &lt;- pldat[[1]]
      pl2 &lt;- pldat[[2]]
      
      # leg vals as factor 
      pl1[[cvar]] &lt;- factor(pl1[[cvar]], 
                            levels = sort(unique(pl1[[cvar]]), decreasing = T),
                            labels = round(sort(unique(pl1[[cvar]]), decreasing = T), 1)
      )
      
      # colors
      cols &lt;- RColorBrewer::brewer.pal(9, &#39;RdBu&#39;)
      
      # names for aes_string
      nms &lt;- names(pl1)
  
      p1 &lt;- ggplot() +
        geom_ribbon(data = pl1, aes_string(x = nms[3], ymin = &#39;lo&#39;, ymax = &#39;hi&#39;, group = nms[4]), alpha = 0.5, fill = &#39;grey&#39;) +
        geom_line(data = pl1, aes_string(x = nms[3], y = nms[1], group = nms[4], colour = nms[4]), size = 1) + 
        geom_text(data = pl2, aes(x= x, y = y, label = lab), hjust = 0) +
        theme_bw() +
        xlab(parse(text = xvar)) +
        scale_colour_manual(parse(text = legr), values = c(rev(cols)[1], cols[1])) +
        scale_y_continuous(nms[1])
      
      return(p1)
      
    })
  )

p1 &lt;- toplo$plos[[1]] + ggtitle(&#39;(b)&#39;) + xlab(&#39;Chla&#39;)
p2 &lt;- toplo$plos[[2]] + ggtitle(&#39;(a)&#39;)
p3 &lt;- toplo$plos[[3]] + ggtitle(&#39;(c)&#39;)

pA &lt;- ggplot_gtable(ggplot_build(p1))
pB &lt;- ggplot_gtable(ggplot_build(p2))
pC &lt;- ggplot_gtable(ggplot_build(p3))

maxWidth = grid::unit.pmax(pA$widths[2:3], pB$widths[2:3], pC$widths[2:3])

pA$widths[2:3] &lt;- maxWidth
pB$widths[2:3] &lt;- maxWidth
pC$widths[2:3] &lt;- maxWidth

grid.arrange(
 pB, pA, pC, ncol = 1 
)</code></pre>
<p><img src="figures_files/figure-html/effbio.png" width="100%" style="display: block; margin: auto;" /> Fig. 6 Examples of model interactions of co-occuring environmental variables on pteropod cellular responses. Plot (a) shows a negative additive effect between aragonite saturation state (Ωar) and temperature on cellular toxicity (lipid peroxidation; LPX); plot (b) shows negative additive effects of food availability and pCO2 on LPX; plot (c) shows positive additive effects of temperature and Ωar on antioxidative activity (sodium dismutase, SOD). Both y-axes are transformed to conform to model output. Covarying environmental variables were held constant at the minimum and maximum values in the observed data.</p>
<pre class="r"><code>toplo &lt;- rbind(
    phymod[phymod$Model == &#39;mod8&#39;, ],
    phymod[phymod$Model == &#39;mod10&#39;, ],
    phymod[phymod$Model == &#39;mod2&#39;, ]
  ) %&gt;% 
  mutate(
    cvar = c(&#39;Temp&#39;, &#39;O2&#39;, &#39;Temp&#39;),
    xvar = c(&#39;Omega[ar]&#39;, &#39;Temp&#39;,&#39;Omega[ar]&#39;), 
    yvar = c(&#39;Dissolution&#39;, &#39;Dissolution&#39;, &#39;Abundance&#39;), 
    legr = c(&#39;Temp&#39;, &#39;O[2]&#39;,&#39;Temp&#39;),
    pos = c(&#39;right&#39;, &#39;left&#39;,&#39;left&#39;), 
    fct = c(1.04, 0.97, 0.92), 
    hjs = c(1, 0, 0)
    ) %&gt;% 
  mutate(
    pldat = pmap(list(Modobj, cvar, pos, fct), function(Modobj, cvar, pos, fct){

      get_pldat(Modobj, cvar, pos = pos, fct = fct)
    
    }),
    plos = pmap(list(pldat, xvar, yvar, cvar, legr, hjs), function(pldat, xvar, yvar, cvar, legr, hjs){
      
      pl1 &lt;- pldat[[1]]
      pl2 &lt;- pldat[[2]]
      
      # leg vals as factor 
      pl1[[cvar]] &lt;- factor(pl1[[cvar]], 
                            levels = sort(unique(pl1[[cvar]]), decreasing = T),
                            labels = round(sort(unique(pl1[[cvar]]), decreasing = T), 1)
      )
      
      # colors
      cols &lt;- RColorBrewer::brewer.pal(9, &#39;RdBu&#39;)
      
      # names for aes_string
      nms &lt;- names(pl1)
      
      p1 &lt;- ggplot() +
        geom_ribbon(data = pl1, aes_string(x = nms[3], ymin = &#39;lo&#39;, ymax = &#39;hi&#39;, group = nms[4]), alpha = 0.5, fill = &#39;grey&#39;) +
        geom_line(data = pl1, aes_string(x = nms[3], y = nms[1], group = nms[4], colour = nms[4]), size = 1) + 
        geom_text(data = pl2, aes(x= x, y = y, label = lab), hjust = hjs) +
        theme_bw() +
        xlab(parse(text = xvar)) +
        scale_colour_manual(parse(text = legr), values = c(rev(cols)[1], cols[1])) +
        scale_y_continuous(yvar)
      
      return(p1)
      
    })
  )

p1 &lt;- toplo$plos[[1]] + ggtitle(&#39;(a)&#39;)
p2 &lt;- toplo$plos[[2]] + ggtitle(&#39;(b)&#39;)
p3 &lt;- toplo$plos[[3]] + ggtitle(&#39;(c)&#39;)


pA &lt;- ggplot_gtable(ggplot_build(p1))
pB &lt;- ggplot_gtable(ggplot_build(p2))
pC &lt;- ggplot_gtable(ggplot_build(p3))

maxWidth = grid::unit.pmax(pA$widths[2:3], pB$widths[2:3], pC$widths[2:3])

pA$widths[2:3] &lt;- maxWidth
pB$widths[2:3] &lt;- maxWidth
pC$widths[2:3] &lt;- maxWidth

grid.arrange(
 pA, pB, pC, ncol = 1 
)</code></pre>
<p><img src="figures_files/figure-html/effphy.png" width="100%" style="display: block; margin: auto;" /> Fig. 7 Examples of model interactions and additive effects of co-occurring environmental variables with biomineralization (shell dissolution) and population (abundance) responses. Co-occurring effects between aragonite saturation state (Ωar) and temperature on shell dissolution are shown in (a), temperature and O2 on dissolution in (b), and temperature and aragonite saturation state on abundance in (c). All y-axes are transformed to conform to model output. Covarying environmental variables were held constant at the minimum and maximum values in the observed data.</p>
<pre class="r"><code>biotab &lt;- biomod %&gt;% 
  unnest(data) %&gt;% 
  group_by(Model) %&gt;% 
  mutate(n = n()) %&gt;% 
  filter(n &gt; 1) %&gt;% 
  dplyr::select(-n)
biotab &lt;- filter(biomod, Model %in% unique(biotab$Model))

cap &lt;- &#39;Table 1: Model results for pteropod cellular response to pairs of co-occurring environmental variables. The estimated joint effects of variables and their significance in each model are shown.  Parameter estimates are included with overall model statistics (R-squared, F statistic) at the bottom. Models with the same cellular response measure can be identified with the column names at the top.  * p &lt; 0.05, ** p &lt; 0.01&#39;

stargazer(biotab$Modobj, type = &#39;html&#39;, title = cap, digits = 2, keep.stat = c(&#39;adj.rsq&#39;), intercept.top = T, intercept.bottom = F, dep.var.caption = &#39;Cellular response measures&#39;, report = &#39;vc*&#39;, star.char = c(&quot;&quot;, &quot;*&quot;, &quot;**&quot;), omit = &#39;Constant&#39;)</code></pre>
<table style="text-align:center">
<caption>
<strong>Table 1: Model results for pteropod cellular response to pairs of co-occurring environmental variables. The estimated joint effects of variables and their significance in each model are shown. Parameter estimates are included with overall model statistics (R-squared, F statistic) at the bottom. Models with the same cellular response measure can be identified with the column names at the top. * p &lt; 0.05, ** p &lt; 0.01</strong>
</caption>
<tr>
<td colspan="14" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="13">
Cellular response measures
</td>
</tr>
<tr>
<td>
</td>
<td colspan="13" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="4">
LPX
</td>
<td colspan="5">
ORACvLPX
</td>
<td colspan="4">
SOD
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
<td>
(5)
</td>
<td>
(6)
</td>
<td>
(7)
</td>
<td>
(8)
</td>
<td>
(9)
</td>
<td>
(10)
</td>
<td>
(11)
</td>
<td>
(12)
</td>
<td>
(13)
</td>
</tr>
<tr>
<td colspan="14" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Fluor
</td>
<td>
-11.07<sup>**</sup>
</td>
<td>
</td>
<td>
-7.64<sup>*</sup>
</td>
<td>
-9.73<sup>*</sup>
</td>
<td>
320.02<sup>**</sup>
</td>
<td>
</td>
<td>
256.12<sup>*</sup>
</td>
<td>
226.61<sup>**</sup>
</td>
<td>
287.36<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
pCO2
</td>
<td>
0.01<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-0.27<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
0.10<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Ara
</td>
<td>
</td>
<td>
-8.43<sup>*</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
227.87<sup>**</sup>
</td>
<td>
132.98<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-80.21<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Temp
</td>
<td>
</td>
<td>
1.82<sup></sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-50.51<sup>*</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
11.24<sup></sup>
</td>
<td>
19.58<sup>*</sup>
</td>
<td>
9.39<sup></sup>
</td>
<td>
12.28<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
O2
</td>
<td>
</td>
<td>
</td>
<td>
-0.03<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
0.91<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-0.35<sup>**</sup>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
pH
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-15.27<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
418.53<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-169.62<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="14" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.72
</td>
<td>
0.50
</td>
<td>
0.74
</td>
<td>
0.65
</td>
<td>
0.87
</td>
<td>
0.58
</td>
<td>
0.61
</td>
<td>
0.88
</td>
<td>
0.82
</td>
<td>
0.54
</td>
<td>
0.50
</td>
<td>
0.61
</td>
<td>
0.55
</td>
</tr>
<tr>
<td colspan="14" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="13" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
<pre class="r"><code>phytab &lt;- phymod %&gt;% 
  unnest(data) %&gt;% 
  group_by(Model) %&gt;% 
  mutate(n = n()) %&gt;% 
  filter(n &gt; 1) %&gt;% 
  dplyr::select(-n)
phytab &lt;- filter(phymod, Model %in% unique(phytab$Model))

cap &lt;- &#39;Table 2: Model results for physiological and abundance responses to pairs of co-occurring environmental variables. The estimated joint effects of variables and their significance in each model are shown.  Parameter estimates are included with overall model statistics (R-squared, F statistic) at the bottom. Models with the same response measure can be identified with the column names at the top. * p &lt; 0.05, ** p &lt; 0.01&#39;

stargazer(phytab$Modobj, type = &#39;html&#39;, title = cap, digits = 2, keep.stat = c(&#39;adj.rsq&#39;), intercept.top = T, intercept.bottom = F, dep.var.caption = &#39;Physiological response measures&#39;, dep.var.labels = c(&#39;Abundance&#39;, &#39;Shell dissolution&#39;), report = &#39;vc*&#39;, star.char = c(&quot;&quot;, &quot;*&quot;, &quot;**&quot;), omit = &#39;Constant&#39;)</code></pre>
<table style="text-align:center">
<caption>
<strong>Table 2: Model results for physiological and abundance responses to pairs of co-occurring environmental variables. The estimated joint effects of variables and their significance in each model are shown. Parameter estimates are included with overall model statistics (R-squared, F statistic) at the bottom. Models with the same response measure can be identified with the column names at the top. * p &lt; 0.05, ** p &lt; 0.01</strong>
</caption>
<tr>
<td colspan="9" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="8">
Physiological response measures
</td>
</tr>
<tr>
<td>
</td>
<td colspan="8" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td colspan="4">
Abundance
</td>
<td colspan="4">
Shell dissolution
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
(1)
</td>
<td>
(2)
</td>
<td>
(3)
</td>
<td>
(4)
</td>
<td>
(5)
</td>
<td>
(6)
</td>
<td>
(7)
</td>
<td>
(8)
</td>
</tr>
<tr>
<td colspan="9" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Fluor
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-0.33<sup>*</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
pCO2
</td>
<td>
-0.002<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
0.0004<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Ara
</td>
<td>
</td>
<td>
1.45<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-1.27<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
O2
</td>
<td>
</td>
<td>
</td>
<td>
0.01<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-0.01<sup>**</sup>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
pH
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
3.12<sup>**</sup>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
-0.83<sup>**</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Temp
</td>
<td>
-0.31<sup>**</sup>
</td>
<td>
-0.44<sup>**</sup>
</td>
<td>
-0.30<sup>**</sup>
</td>
<td>
-0.32<sup>**</sup>
</td>
<td>
</td>
<td>
-0.11
</td>
<td>
-0.15<sup></sup>
</td>
<td>
0.05<sup>*</sup>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
Ara:Temp
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
0.10<sup>*</sup>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
O2:Temp
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
0.001<sup>*</sup>
</td>
<td>
</td>
</tr>
<tr>
<td style="text-align:left">
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
<td>
</td>
</tr>
<tr>
<td colspan="9" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
Adjusted R<sup>2</sup>
</td>
<td>
0.40
</td>
<td>
0.51
</td>
<td>
0.43
</td>
<td>
0.45
</td>
<td>
0.71
</td>
<td>
0.87
</td>
<td>
0.87
</td>
<td>
0.69
</td>
</tr>
<tr>
<td colspan="9" style="border-bottom: 1px solid black">
</td>
</tr>
<tr>
<td style="text-align:left">
<em>Note:</em>
</td>
<td colspan="8" style="text-align:right">
<sup><em></sup>p&lt;0.1; <sup><strong></sup>p&lt;0.05; <sup></strong></em></sup>p&lt;0.01
</td>
</tr>
</table>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
